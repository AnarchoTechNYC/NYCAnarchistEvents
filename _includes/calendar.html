{% comment %}
This is the "main" calendar HTML base code. It's the
primary included file that makes up the bulk of the app
itself and defines the containing calendar element and
any of the custom interactive elements needed.
{% endcomment -%}

<div id="calendar-container">

    <div id="calendar">
        <noscript>This calendar needs JavaScript to function. Please <a href="https://enable-javascript.com/">enable JavaScript in your browser</a>, or disable any active script blockers for this site.</noscript>
    </div>

    <div id="calendar-loading-spinner" class="lds-dual-ring"><span>Loading&hellip;</span></div>

</div><!-- #calendar-container -->

<div id="calendar-filter-modal" class="modal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Filter calendar</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <template id="filter-list-item-template">
                    <style>
li {
    list-style-type: none;
    text-align: left;
}
                    </style>
                    <li>
                        <input class="form-check-input"
                            id=""
                            type="checkbox"
                            checked="checked"
                            value=""
                        />
                        <label class="form-check-label" for="">
                            <slot name="item-name">Event source name</slot>
                        </label>
                    </li>
                </template>
                <p>Choose which events to show or hide.</p>
                <form>
                    <fieldset id="filter-event-sources" class="form-group">
                        <legend>Sources</legend>
                        <details>
                            <summary>Filter all events by their source</summary>
                            <ul>
                                <!--
                                    Dynamically fills with
                                    list items based on the
                                    event sources defined.
                                -->
                            </ul>
<script type="module">
import { default as calendar } from '{% link static/js/calendar.js %}';
window.addEventListener('DOMContentLoaded', function (e) {
    calendar.getEventSources().sort(function (a, b) {
        var x = a.internalEventSource.extendedProps.name;
        var y = b.internalEventSource.extendedProps.name;
        return x.localeCompare(y);
    }).forEach(function (s) {
        var el = document.createElement('calendar-filter-list-item');
        el.dataset.id = s.id;
        var nameSlot = document.createElement('span');
        nameSlot.setAttribute('slot', 'item-name');
        nameSlot.appendChild(document.createTextNode(s.internalEventSource.extendedProps.name));
        el.appendChild(nameSlot);
        document.getElementById('filter-event-sources')
            .querySelector('ul')
            .appendChild(el);
    });
});
</script>
                        </details>
                    </fieldset>
                    <!-- TODO: Not yet implemented.
                    <fieldset id="filter-event-categories" class="form-group">
                        <legend>Categories</legend>
                        <ul>
                        </ul>
                    </fieldset>
                    -->
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Apply</button>
            </div>
        </div>
    </div>
</div><!-- #calendar-filter-modal -->
